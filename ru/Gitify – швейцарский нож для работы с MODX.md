# Gitify – швейцарский нож для работы с MODX

![Gitify – швейцарский нож для работы с MODX](https://dl.dropboxusercontent.com/u/4331938/gitify-swis-knife.jpg)

Все, кто когда-либо работал над большим MODX сайтом с несколькими стадиями жизни проекта (dev, test/stage, production) или пробовал работать над таким сайтом в команде, обязательно сталкивались с основным недостатком MODX – сохранением элементов кода в базе данных, и как следствие, отсутствием вменяемых способов использовать систему контроля версий. Найдутся те, кто скажут, что это не самая главная проблема и они её решили так-то и так-то и будут правы. На сегодня решений данной проблемы существует уже более 5 (мне известных) и все они разной степени костыльности, включая и Gitify, о котором ниже пойдет речь. Но костыль с моторчиком ;)

Кому лень читать, может сразу пролистать вниз и посмотреть бонусное видео. Остальных призываю прочитать строки ниже, это будет полезно, обещаю.

=== кат ===

В самом MODX есть статические элементы, призванные частично решить проблему сохранения кода в БД, но выглядит все это малопригодным для каждодневного использования. Возможность сохранять есть, но функций со стороны панели управления, позволяющих как-то упростить этот процесс, нет. По этой причине мной в свое время был создан [SE Manager](http://modx.com/extras/package/semanagerformodx), который частично эту проблему решал. Примерно с той же целью был создан [Teleport](https://github.com/modxcms/teleport) (я о нем рассказывал на прошлогоднем MODX Meetup Minsk), который немного по другому, но решает ту же проблему: собирает все в пакет на одной копии MODX и переносит её на другую. Teleport решает это через родные для MODX транспортные пакеты. Те же пакеты, через которые распространяются все дополнения. Конечно, существует еще несколько решений и подходов, но о них в другой раз.

## Но что же Gitify?

После полугода активного использования скажу, что такой же костыль, хотя и несколько удобнее остальных. Тем не менее задачу решает и решает на удивление хорошо, хотя без моей помощи не обошлось.

Gitify – это набор команд (функций), помогающих в работе с сайтом на MODX. И это буквально. Каждая функция — это отдельный класс и отдельная команда, которая отвечает только за ту область деятельности, для которой создавалась. 

[Первый комит](https://github.com/modmore/Gitify/commit/30f3bf181204934cc2c5cfeb256617f6ba8a6b51) в репозиторий был сделан 1 июня 2014 года. Марк Хамстра анонсировал данный инструмент на большой конференции MODX Weekend в сентябре 2014. Летом этого года я перевел [документацию](http://modmore.github.io/Gitify/ru/) на русский язык, но этого мало, разработчики не до конца осознают от него пользу. Что ж, попробуем исправить ситуацию.

Основная задача Gitify – это собрать действующий сайт (элементы сайта) в человекочитаемый формат, сохранить в файл и точно так же восстановить его, но уже в другом месте (на сервере, например). Важное в этом процессе — человекочитаемый формат и то, что версиями этих файлов можно управлять посредством git и других VCS.

> Читаемость кода крайне важна при работе в команде. При должном подходе к работе и рабочему процессу, обязательно должна быть стадия code review. Code review позволяет максимально быстро обмениваться опытом между участниками команды и учиться у коллег. К тому же code review избавляет от нелепых ошибок, которые видят коллеги, но которые разработчик мог пропустить из-за усталости или из-за того, что давно работает с участком кода и глаз замылился. В таком случае транспортные пакеты, которые создает Teleport, малопригодны, а вот код, генерируемый Gitify, полностью доступен и понятен (исходники и немного конфигов в yaml).

Уверен, что понятнее не стало, поэтому предлагаю установить Gitify и попробовать все на практике.

## Установка

Gitify написан на PHP и для работы требует PHP версии не ниже 5.3 в cli-режиме. Так же для установки требуется composer. Если вы еще не в курсе, что это такое, то пора бы узнать, иначе останетесь на задворках современной web-разработки.

> Я привожу примеры установки для MacOS/Linux, Windows у меня увы нет, но если у вас стоит gitbash, то скорее всего проблем не будет, разве что пути нужно будет немного по другому писать.

### Установка Composer

Идем по [этой ссылке](https://getcomposer.org/doc/00-intro.md) и устанавливаем composer в систему. Подробнее описывать не стану, тема гуглится в один клик.

### Установка Gitify

=== нужно дописать подробнее

Чтобы установить Gitify, достаточно клонировать репозиторий в удобную для вас папку, и запустить команду `composer install` (или скачать composer.phar в папку и запустить `php composer.phar install`, если с установкой composer налажали) внутри этой папки. Чтобы не писать каждый раз полный путь к папке с Gitify, можно добавить путь в переменную окружения $PATH. Делается это так: 
=== тут написать команду для экспорта в переменную окружения
Либо добавить alias в терминал. Я пользуюсь zsh, поэтому добавил в файл `~/.zshrc` строку `alias gitify=“php /path/to/gitify/Gitify”`. На этом все. Попробуйте запустить `gitify`, результат должен получиться примерно такой:

=== пример вывода команды gitify

> Далее в примерах я буду вызывать Gitify, как уже добавленный alias, т.е. просто `gitify`.

## Конфигурация

Без конфигурации конечно же никуда, но в Gitify она простая, я бы даже сказал слишком простая. Для работы Gitify требуется один файл конфигурации в корне с сайтом — `.gitify`. В этом файле описываются те сущности, которые требуется сохранить из действующего сайта и развернуть на том, где это нужно.

Для создания конфигурации для достаточно написать `gitify init`

## Основные команды

### extract и build
### backup и restore
### modx:install, modx:upgrade
### package:install

## Что можно делать с Gitify

Давайте рассмотрим реальные ситуации из жизни проектов и попробуем написать сценарии по применению Gitify.

- создаем сайт с нуля
- есть готовый сайт, нужно перевести в git для деплоя
- есть сайт, нужно бекапить как-то
- есть команда, нужно организовать работу, чтобы всем было удобно и ничего не ломалось

— ограничения?

## Бонусное видео. Как и обещал

=== video ===

## Вердикт

О Gitify в сообществе пока мало кто знает, несмотря на наличие документации на русском. Хотя уверен, что именно эту статью все ждали с нетерпением, чтобы начать работать с Gitify. Опытные разработчики уже используют свои настроенные и проверенные решения, а новичкам пока не до проблем сопровождения, научиться бы просто сайты собирать. А что делать обычным ремесленникам? Мой ответ - пробовать Gitify. По моему мнению, на сегодня это пока что лучший инструмент для управления MODX сайтом.

Gitify как проект активно развивается. [С недавнего времени](https://twitter.com/mark_hamstra/status/653956905031872512) я так же являюсь официальным разработчиков Gitify, поэтому вопросы и пожелания, а так же сообщения об ошибках можно слать мне. Конечно, у нас с Марком хватает своей работы, и мы не можем уделять все время этому проекту, но стараемся улучшать инструмент, с которым приходится работать каждый день. 

Спасибо за внимание!

